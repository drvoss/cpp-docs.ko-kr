---
title: CRowset 클래스
ms.date: 11/04/2016
f1_keywords:
- ATL.CRowset<TAccessor>
- CRowset
- ATL::CRowset
- ATL::CRowset<TAccessor>
- ATL.CRowset
- CRowset<TAccessor>.AddRefRows
- CRowset.AddRefRows
- ATL.CRowset.AddRefRows
- AddRefRows
- CRowset::AddRefRows
- CRowset<TAccessor>::AddRefRows
- ATL::CRowset::AddRefRows
- ATL.CRowset<TAccessor>.AddRefRows
- ATL::CRowset<TAccessor>::AddRefRows
- CRowset::Close
- ATL.CRowset.Close
- CRowset<TAccessor>::Close
- CRowset<TAccessor>.Close
- ATL.CRowset<TAccessor>.Close
- ATL::CRowset::Close
- ATL::CRowset<TAccessor>::Close
- CRowset.Close
- CRowset<TAccessor>.Compare
- CRowset<TAccessor>::Compare
- ATL.CRowset<TAccessor>.Compare
- ATL::CRowset<TAccessor>::Compare
- CRowset.Compare
- ATL::CRowset::Compare
- ATL.CRowset.Compare
- CRowset::Compare
- CRowset<TAccessor>::CRowset
- CRowset.CRowset
- ATL::CRowset::CRowset
- ATL::CRowset<TAccessor>::CRowset
- ATL.CRowset.CRowset
- CRowset<TAccessor>.CRowset
- CRowset::CRowset
- ATL.CRowset<TAccessor>.CRowset
- ATL::CRowset::Delete
- CRowset.Delete
- CRowset::Delete
- ATL.CRowset.Delete
- ATL::CRowset<TAccessor>::Delete
- CRowset<TAccessor>.Delete
- CRowset<TAccessor>::Delete
- ATL.CRowset<TAccessor>.Delete
- ATL.CRowset.FindNextRow
- CRowset<TAccessor>.FindNextRow
- ATL::CRowset::FindNextRow
- CRowset::FindNextRow
- CRowset<TAccessor>::FindNextRow
- CRowset.FindNextRow
- ATL.CRowset<TAccessor>.FindNextRow
- ATL::CRowset<TAccessor>::FindNextRow
- FindNextRow
- ATL::CRowset::GetApproximatePosition
- ATL::CRowset<TAccessor>::GetApproximatePosition
- CRowset.GetApproximatePosition
- CRowset::GetApproximatePosition
- GetApproximatePosition
- ATL.CRowset.GetApproximatePosition
- CRowset<TAccessor>::GetApproximatePosition
- CRowset<TAccessor>::GetData
- ATL::CRowset<TAccessor>::GetData
- ATL::CRowset::GetData
- ATL.CRowset<TAccessor>.GetData
- CRowset<TAccessor>.GetData
- CRowset::GetData
- CRowset.GetData
- ATL.CRowset.GetData
- CRowset<TAccessor>::GetDataHere
- CRowset<TAccessor>.GetDataHere
- CRowset.GetDataHere
- GetDataHere
- CRowset::GetDataHere
- ATL::CRowset::GetDataHere
- ATL::CRowset<TAccessor>::GetDataHere
- ATL.CRowset<TAccessor>.GetDataHere
- ATL.CRowset.GetDataHere
- ATL.CRowset<TAccessor>.GetOriginalData
- CRowset<TAccessor>::GetOriginalData
- ATL::CRowset<TAccessor>::GetOriginalData
- ATL.CRowset.GetOriginalData
- CRowset::GetOriginalData
- ATL::CRowset::GetOriginalData
- CRowset.GetOriginalData
- CRowset.GetRowStatus
- ATL.CRowset<TAccessor>.GetRowStatus
- ATL::CRowset<TAccessor>::GetRowStatus
- CRowset::GetRowStatus
- ATL::CRowset::GetRowStatus
- CRowset<TAccessor>::GetRowStatus
- ATL.CRowset.GetRowStatus
- CRowset<TAccessor>.GetRowStatus
- ATL.CRowset<TAccessor>.Insert
- CRowset.Insert
- CRowset<TAccessor>.Insert
- CRowset<TAccessor>::Insert
- ATL::CRowset<TAccessor>::Insert
- ATL.CRowset.Insert
- CRowset::Insert
- ATL::CRowset::Insert
- CRowset::IsSameRow
- CRowset.IsSameRow
- ATL::CRowset::IsSameRow
- ATL.CRowset.IsSameRow
- CRowset<TAccessor>::IsSameRow
- ATL.CRowset<TAccessor>.IsSameRow
- CRowset<TAccessor>.IsSameRow
- ATL::CRowset<TAccessor>::IsSameRow
- CRowset<TAccessor>::MoveFirst
- ATL::CRowset::MoveFirst
- CRowset<TAccessor>.MoveFirst
- CRowset::MoveFirst
- CRowset.MoveFirst
- ATL.CRowset.MoveFirst
- ATL.CRowset<TAccessor>.MoveFirst
- ATL::CRowset<TAccessor>::MoveFirst
- ATL::CRowset<TAccessor>::MoveLast
- CRowset<TAccessor>::MoveLast
- ATL.CRowset.MoveLast
- ATL::CRowset::MoveLast
- CRowset<TAccessor>.MoveLast
- CRowset::MoveLast
- ATL.CRowset<TAccessor>.MoveLast
- CRowset.MoveLast
- ATL.CRowset<TAccessor>.MoveNext
- ATL.CRowset.MoveNext
- ATL::CRowset<TAccessor>::MoveNext
- CRowset<TAccessor>.MoveNext
- CRowset.MoveNext
- CRowset<TAccessor>::MoveNext
- CRowset::MoveNext
- ATL::CRowset::MoveNext
- CRowset<TAccessor>.MovePrev
- CRowset.MovePrev
- CRowset::MovePrev
- ATL.CRowset.MovePrev
- ATL::CRowset<TAccessor>::MovePrev
- ATL::CRowset::MovePrev
- ATL.CRowset<TAccessor>.MovePrev
- CRowset<TAccessor>::MovePrev
- ATL::CRowset::MoveToBookmark
- ATL::CRowset<TAccessor>::MoveToBookmark
- ATL.CRowset.MoveToBookmark
- ATL.CRowset<TAccessor>.MoveToBookmark
- CRowset::MoveToBookmark
- CRowset.MoveToBookmark
- CRowset<TAccessor>::MoveToBookmark
- CRowset<TAccessor>::MoveToRatio
- CRowset::MoveToRatio
- CRowset<TAccessor>.MoveToRatio
- ATL.CRowset.MoveToRatio
- ATL::CRowset::MoveToRatio
- CRowset.MoveToRatio
- ATL.CRowset<TAccessor>.MoveToRatio
- ATL::CRowset<TAccessor>::MoveToRatio
- CRowset::ReleaseRows
- ATL::CRowset<TAccessor>::ReleaseRows
- CRowset<TAccessor>.ReleaseRows
- CRowset.ReleaseRows
- ATL.CRowset.ReleaseRows
- ATL.CRowset<TAccessor>.ReleaseRows
- CRowset<TAccessor>::ReleaseRows
- ATL::CRowset::ReleaseRows
- ATL.CRowset<TAccessor>.SetData
- ATL::CRowset::SetData
- CRowset<TAccessor>.SetData
- CRowset::SetData
- ATL.CRowset.SetData
- CRowset.SetData
- CRowset<TAccessor>::SetData
- ATL::CRowset<TAccessor>::SetData
- CRowset.Undo
- ATL::CRowset<TAccessor>::Undo
- CRowset<TAccessor>::Undo
- ATL.CRowset.Undo
- ATL.CRowset<TAccessor>.Undo
- CRowset<TAccessor>.Undo
- ATL::CRowset::Undo
- CRowset::Undo
- Undo
- CRowset.Update
- ATL.CRowset.Update
- ATL.CRowset<TAccessor>.Update
- ATL::CRowset<TAccessor>::Update
- CRowset<TAccessor>::Update
- CRowset::Update
- CRowset<TAccessor>.Update
- ATL::CRowset::Update
- CRowset::UpdateAll
- ATL.CRowset.UpdateAll
- CRowset<TAccessor>.UpdateAll
- ATL.CRowset<TAccessor>.UpdateAll
- UpdateAll
- CRowset.UpdateAl
- ATL::CRowset<TAccessor>::UpdateAll
- CRowset<TAccessor>::UpdateAll
- ATL::CRowset::UpdateAll
helpviewer_keywords:
- CRowset class
- AddRefRows method
- Close method
- Compare method
- CRowset class, constructor
- Delete method
- FindNextRow method
- GetApproximatePosition method
- GetData method [OLE DB]
- GetDataHere method
- GetOriginalData method
- GetRowStatus method
- Insert method
- IsSameRow method
- MoveFirst method
- MoveLast method
- MoveNext method
- MovePrev method
- MoveToBookmark method
- MoveToRatio method
- ReleaseRows method
- SetData method
- Undo method
- Update method
- UpdateAll method
ms.assetid: b0228a90-b8dd-47cc-b397-8d4c15c1e7f4
ms.openlocfilehash: e67e385a8ce0eb9a6b041d4a4f0d43e2db551c79
ms.sourcegitcommit: 857fa6b530224fa6c18675138043aba9aa0619fb
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 03/24/2020
ms.locfileid: "80211291"
---
# <a name="crowset-class"></a>CRowset 클래스

OLE DB rowset 개체와 몇 가지 관련 인터페이스를 캡슐화 하 고 행 집합 데이터에 대 한 조작 메서드를 제공 합니다.

## <a name="syntax"></a>구문

```cpp
template <class TAccessor = CAccessorBase>
class CRowset
```

### <a name="parameters"></a>매개 변수

*TAccessor*<br/>
접근자 클래스입니다. 기본값은 `CAccessorBase`입니다.

## <a name="requirements"></a>요구 사항

**헤더:** atldbcli.h

## <a name="members"></a>멤버

### <a name="methods"></a>메서드

|||
|-|-|
|[AddRefRows](#addrefrows)|현재 행과 연결 된 참조 횟수를 늘립니다.|
|[닫기](#close)|행과 현재 `IRowset` 인터페이스를 해제 합니다.|
|[비교](#compare)|[IRowsetLocate:: Compare](/previous-versions/windows/desktop/ms709539(v=vs.85))를 사용 하 여 두 책갈피를 비교 합니다.|
|[CRowset](#crowset)|새 `CRowset` 개체를 만들고 (선택 사항) 매개 변수로 제공 된 `IRowset` 인터페이스에 연결 합니다.|
|[Delete](#delete)|[IRowsetChange: DeleteRows](/previous-versions/windows/desktop/ms724362(v=vs.85))를 사용 하 여 행 집합에서 행을 삭제 합니다.|
|[FindNextRow](#findnextrow)|지정 된 책갈피 다음에 일치 하는 다음 행을 찾습니다.|
|[GetApproximatePosition](#getapproximateposition)|책갈피에 해당 하는 행의 대략적인 위치를 반환 합니다.|
|[GetData](#getdata)|행 집합의 행 복사본에서 데이터를 검색합니다.|
|[GetDataHere](#getdatahere)|지정 된 버퍼에서 데이터를 검색 합니다.|
|[GetOriginalData](#getoriginaldata)|가장 최근에 데이터 원본에서 인출 되거나 전송 된 데이터를 검색 하 여 보류 중인 변경 내용을 무시 합니다.|
|[GetRowStatus](#getrowstatus)|모든 행의 상태를 반환 합니다.|
|[삽입](#insert)|[IRowsetChange: InsertRow](/previous-versions/windows/desktop/ms716921(v=vs.85))를 사용 하 여 새 행을 만들고 삽입 합니다.|
|[IsSameRow](#issamerow)|지정 된 행을 현재 행과 비교 합니다.|
|[MoveFirst](#movefirst)|다음 인출 위치를 초기 위치로 위치를 이동 합니다.|
|[MoveLast](#movelast)|마지막 레코드로 이동 합니다.|
|[MoveNext](#movenext)|다음 행의 데이터 또는 지정 된 위치 수 만큼 다음 행을 인출 합니다.|
|[MovePrev](#moveprev)|이전 레코드로 이동 합니다.|
|[MoveToBookmark](#movetobookmark)|책갈피로 표시 된 행 또는 해당 책갈피의 지정 된 오프셋에 있는 행을 인출 합니다.|
|[MoveToRatio](#movetoratio)|행 집합의 소수 위치에서 시작 하 여 행을 인출 합니다.|
|[ReleaseRows](#releaserows)|[IRowset:: ReleaseRows](/previous-versions/windows/desktop/ms719771(v=vs.85)) 를 호출 하 여 현재 행 핸들을 해제 합니다.|
|[SetData](#setdata)|[IRowsetChange: SetData](/previous-versions/windows/desktop/ms721232(v=vs.85))를 사용 하 여 하나 이상의 행 열에 데이터 값을 설정 합니다.|
|[실행 취소](#undo)|마지막 인출 또는 [업데이트](../../data/oledb/crowset-update.md)이후 행에 적용 된 변경 내용을 취소 합니다.|
|[Update](#update)|마지막 인출 또는 업데이트 이후 현재 행에 대해 보류 중인 변경 내용을 모두 전송 합니다.|
|[UpdateAll](#updateall)|마지막 인출 또는 업데이트 이후의 모든 행에 대 한 보류 중인 변경 내용을 모두 전송 합니다.|

## <a name="remarks"></a>주의

OLE DB에서 행 집합은 프로그램에서 데이터를 설정 하 고 검색 하는 데 사용할 수 있는 개체입니다.

이 클래스는 인스턴스화되지 않고 `CTable` 또는 `CCommand`에 대 한 템플릿 매개 변수로 전달 됩니다 (`CRowset` 기본값).

## <a name="crowsetaddrefrows"></a><a name="addrefrows"></a>CRowset:: AddRefRows

[IRowset:: AddRefRows](/previous-versions/windows/desktop/ms719619(v=vs.85)) 를 호출 하 여 현재 행 핸들과 연결 된 참조 수를 하나씩 늘립니다.

### <a name="syntax"></a>구문

```cpp
HRESULT AddRefRows() throw();
```

### <a name="return-value"></a>반환 값

표준 HRESULT입니다.

### <a name="remarks"></a>주의

이 메서드는 현재 행 핸들의 참조 횟수를 증가 시킵니다. [ReleaseRows](../../data/oledb/crowset-releaserows.md) 를 호출 하 여 카운트를 감소 시킵니다. Move 메서드에 의해 반환 된 행의 참조 횟수는 1입니다.

## <a name="crowsetclose"></a><a name="close"></a>CRowset:: Close

행과 현재 [IRowset](/previous-versions/windows/desktop/ms720986(v=vs.85)) 인터페이스를 해제 합니다.

### <a name="syntax"></a>구문

```cpp
void Close() throw();
```

### <a name="remarks"></a>주의

이 메서드는 현재 행 집합에 있는 모든 행을 해제 합니다.

## <a name="crowsetcompare"></a><a name="compare"></a>CRowset:: Compare

[IRowsetLocate:: Compare](/previous-versions/windows/desktop/ms709539(v=vs.85))를 사용 하 여 두 책갈피를 비교 합니다.

### <a name="syntax"></a>구문

```cpp
HRESULT Compare(const CBookmarkBase& bookmark1,
   const CBookmarkBase& bookmark2,
   DBCOMPARE* pComparison) const throw();
```

#### <a name="parameters"></a>매개 변수

*않고 책갈피 2*<br/>
진행 비교할 첫 번째 책갈피입니다.

*Bookmark2 등*<br/>
진행 비교할 두 번째 책갈피입니다.

*pComparison*<br/>
제한이 비교 결과에 대 한 포인터입니다.

### <a name="return-value"></a>반환 값

표준 HRESULT입니다.

### <a name="remarks"></a>주의

이 메서드에는 모든 공급자에서 지원 되지 않을 수 있는 선택적 인터페이스 `IRowsetLocate`필요 합니다. 이 경우 메서드는 E_NOINTERFACE를 반환 합니다. 또한 행 집합을 포함 하는 테이블이 나 명령에서 `Open`를 호출 하기 전에 `DBPROP_IRowsetLocate`를 VARIANT_TRUE으로 설정 해야 합니다.

소비자에서 책갈피를 사용 하는 방법에 대 한 자세한 내용은 [책갈피 사용](../../data/oledb/using-bookmarks.md)을 참조 하세요.

## <a name="crowsetcrowset"></a><a name="crowset"></a>CRowset:: CRowset

새 `CRowset` 개체를 만들고 (선택 사항) 매개 변수로 제공 된 [IRowset](/previous-versions/windows/desktop/ms720986(v=vs.85)) 인터페이스에 연결 합니다.

### <a name="syntax"></a>구문

```cpp
CRowset();

CRowset(IRowset* pRowset);
```

#### <a name="parameters"></a>매개 변수

*pRowset*<br/>
[in] 이 클래스와 연결된 `IRowset` 인터페이스에 대한 포인터입니다.

## <a name="crowsetdelete"></a><a name="delete"></a>CRowset::D e)

[IRowsetChange::D eleterows](/previous-versions/windows/desktop/ms724362(v=vs.85)) 를 호출 하 여 행 집합에서 현재 행을 삭제 합니다.

### <a name="syntax"></a>구문

```cpp
HRESULT Delete() const throw();
```

### <a name="return-value"></a>반환 값

표준 HRESULT입니다.

## <a name="crowsetfindnextrow"></a><a name="findnextrow"></a>CRowset:: FindNextRow

지정 된 책갈피 다음에 일치 하는 다음 행을 찾습니다.

### <a name="syntax"></a>구문

```cpp
HRESULT FindNextRow(DBCOMPAREOP op,
   BYTE* pData,
   DBTYPE wType,
   DBLENGTH nLength,
   BYTE bPrecision,
   BYTE bScale,
   BOOL bSkipCurrent = TRUE,
   CBookmarkBase* pBookmark = NULL) throw();
```

#### <a name="parameters"></a>매개 변수

*op*<br/>
진행 행 값을 비교 하는 데 사용 하는 작업입니다. 값은 [IRowsetFind:: FindNextRow](/previous-versions/windows/desktop/ms723091(v=vs.85))를 참조 하세요.

*pData*<br/>
진행 일치 시킬 값에 대 한 포인터입니다.

*wType*<br/>
진행 버퍼의 값 부분에 대 한 데이터 형식을 나타냅니다. 형식 표시기에 대 한 자세한 내용은 Windows SDK에서 *OLE DB 프로그래머 참조* 의 [데이터 형식](/previous-versions/windows/desktop/ms723969(v=vs.85)) 을 참조 하세요.

*nLength*<br/>
진행 데이터 값에 대해 할당 된 소비자 데이터 구조의 길이 (바이트)입니다. 자세한 내용은 *OLE DB 프로그래머 참조* 에서 [DBBINDING 구조체](/previous-versions/windows/desktop/ms716845(v=vs.85)) 의 `cbMaxLen`에 대 한 설명을 참조 하세요.

*bPrecision*<br/>
진행 데이터를 가져올 때 사용 되는 최대 전체 자릿수입니다. *Wtype* 이 DBTYPE_NUMERIC 경우에만 사용 됩니다. 자세한 내용은 *OLE DB 프로그래머 참조*에서 [DBTYPE_NUMERIC 관련 변환 또는 DBTYPE_DECIMAL](/previous-versions/windows/desktop/ms719714(v=vs.85)) 을 참조 하세요.

*bScale*<br/>
진행 데이터를 가져올 때 사용 되는 배율입니다. *Wtype* 이 DBTYPE_NUMERIC 또는 DBTYPE_DECIMAL 경우에만 사용 됩니다. 자세한 내용은 *OLE DB 프로그래머 참조*에서 [DBTYPE_NUMERIC 관련 변환 또는 DBTYPE_DECIMAL](/previous-versions/windows/desktop/ms719714(v=vs.85)) 을 참조 하세요.

*bSkipCurrent*<br/>
진행 검색을 시작할 책갈피의 행 수입니다.

*pBookmark*<br/>
진행 검색을 시작할 위치에 대 한 책갈피입니다.

### <a name="return-value"></a>반환 값

표준 HRESULT입니다.

### <a name="remarks"></a>주의

이 메서드에는 모든 공급자에서 지원 되지 않을 수 있는 선택적 인터페이스 `IRowsetFind`필요 합니다. 이 경우 메서드는 E_NOINTERFACE를 반환 합니다. 또한 행 집합을 포함 하는 테이블이 나 명령에서 `Open`를 호출 하기 전에 `DBPROP_IRowsetFind`를 VARIANT_TRUE으로 설정 해야 합니다.

소비자에서 책갈피를 사용 하는 방법에 대 한 자세한 내용은 [책갈피 사용](../../data/oledb/using-bookmarks.md)을 참조 하세요.

## <a name="crowsetgetapproximateposition"></a><a name="getapproximateposition"></a>CRowset:: GetApproximatePosition

책갈피에 해당 하는 행의 대략적인 위치를 반환 합니다.

### <a name="syntax"></a>구문

```cpp
HRESULT GetApproximatePosition(const CBookmarkBase* pBookmark,
   DBCOUNTITEM* pPosition,
   DBCOUNTITEM* pcRows) throw();
```

#### <a name="parameters"></a>매개 변수

*pBookmark*<br/>
진행 위치가 있는 행을 식별 하는 책갈피에 대 한 포인터입니다. 행 개수만 필요한 경우 NULL입니다.

*pPosition*<br/>
제한이 `GetApproximatePosition` 행의 위치를 반환 하는 위치에 대 한 포인터입니다. 위치가 필요 하지 않은 경우 NULL입니다.

*pcRows*<br/>
제한이 `GetApproximatePosition` 전체 행 수를 반환 하는 위치에 대 한 포인터입니다. 행 개수가 필요 하지 않은 경우 NULL입니다.

### <a name="return-value"></a>반환 값

표준 HRESULT입니다.

### <a name="remarks"></a>주의

이 메서드에는 모든 공급자에서 지원 되지 않을 수 있는 선택적 인터페이스 `IRowsetScroll`필요 합니다. 이 경우 메서드는 E_NOINTERFACE를 반환 합니다. 또한 행 집합을 포함 하는 테이블이 나 명령에서 `Open`를 호출 하기 전에 `DBPROP_IRowsetScroll`를 VARIANT_TRUE으로 설정 해야 합니다.

소비자에서 책갈피를 사용 하는 방법에 대 한 자세한 내용은 [책갈피 사용](../../data/oledb/using-bookmarks.md)을 참조 하세요.

## <a name="crowsetgetdata"></a><a name="getdata"></a>CRowset:: GetData

행 집합의 행 복사본에서 데이터를 검색합니다.

### <a name="syntax"></a>구문

```cpp
HRESULT GetData() throw();

HRESULT GetData(int nAccessor) throw();
```

#### <a name="parameters"></a>매개 변수

*nAccessor*<br/>
진행 데이터에 액세스 하는 데 사용할 접근자의 (0 오프셋) 인덱스 번호입니다.

### <a name="return-value"></a>반환 값

표준 HRESULT입니다.

### <a name="remarks"></a>주의

[BEGIN_ACCESSOR](../../data/oledb/begin-accessor.md)에서 autoaccessor가 아닌 접근자를 지정 하는 경우이 메서드를 사용 하 여 접근자 번호를 전달 하 여 명시적으로 데이터를 가져옵니다.

## <a name="crowsetgetdatahere"></a><a name="getdatahere"></a>CRowset:: GetDataHere

현재 행에서 데이터를 검색 하 여 지정 된 버퍼에 배치 합니다.

### <a name="syntax"></a>구문

```cpp
HRESULT GetDataHere(int nAccessor,
   void* pBuffer) throw();
```

#### <a name="parameters"></a>매개 변수

*nAccessor*<br/>
진행 데이터에 액세스 하는 데 사용할 접근자의 인덱스 번호입니다.

*pBuffer*<br/>
제한이 현재 레코드에 대 한 데이터를 저장할 버퍼입니다.

### <a name="return-value"></a>반환 값

표준 HRESULT입니다.

### <a name="remarks"></a>주의

이 함수를 사용 하는 방법에 대 한 예제는 [Multiread 샘플](../../overview/visual-cpp-samples.md)을 참조 하세요.

## <a name="crowsetgetoriginaldata"></a><a name="getoriginaldata"></a>CRowset:: GetOriginalData

는 `IRowsetUpdate::GetOriginalData`를 호출 하 여 가장 최근에 데이터 원본에서 인출 되거나 전송 된 데이터를 검색 합니다.

### <a name="syntax"></a>구문

```cpp
HRESULT GetOriginalData() throw();
```

### <a name="return-value"></a>반환 값

표준 HRESULT입니다.

### <a name="remarks"></a>주의

이 메서드는 가장 최근에 데이터 원본에서 인출 되거나 데이터 원본으로 전송 된 데이터를 검색 합니다. 보류 중인 변경 내용에 따라 값을 검색 하지 않습니다.

이 메서드에는 모든 공급자에서 지원 되지 않을 수 있는 선택적 인터페이스 `IRowsetUpdate`필요 합니다. 이 경우 메서드는 E_NOINTERFACE를 반환 합니다. 또한 행 집합을 포함 하는 테이블이 나 명령에서 `Open`를 호출 하기 전에 `DBPROP_IRowsetUpdate`를 VARIANT_TRUE으로 설정 해야 합니다.

## <a name="crowsetgetrowstatus"></a><a name="getrowstatus"></a>CRowset:: GetRowStatus

모든 행의 상태를 반환 합니다.

### <a name="syntax"></a>구문

```cpp
HRESULT GetRowStatus(DBPENDINGSTATUS* pStatus) const throw();
```

#### <a name="parameters"></a>매개 변수

*pStatus*<br/>
제한이 `GetRowStatus` 상태 값을 반환 하는 위치에 대 한 포인터입니다. OLE DB 프로그래머 참조에서 DBPENDINGSTATUS를 참조 하세요.

### <a name="return-value"></a>반환 값

표준 HRESULT입니다.

### <a name="remarks"></a>주의

이 메서드에는 모든 공급자에서 지원 되지 않을 수 있는 선택적 인터페이스 `IRowsetUpdate`필요 합니다. 이 경우 메서드는 E_NOINTERFACE를 반환 합니다. 또한 행 집합을 포함 하는 테이블이 나 명령에서 `Open`를 호출 하기 전에 `DBPROP_IRowsetUpdate`를 VARIANT_TRUE으로 설정 해야 합니다.

## <a name="crowsetinsert"></a><a name="insert"></a>CRowset:: Insert

접근자의 데이터를 사용 하 여 새 행을 만들고 초기화 합니다.

### <a name="syntax"></a>구문

```cpp
HRESULT Insert(int nAccessor = 0,
   bool bGetHRow = false) throw();
```

#### <a name="parameters"></a>매개 변수

*nAccessor*<br/>
진행 데이터를 삽입 하는 데 사용할 접근자의 번호입니다.

*bGetHRow*<br/>
진행 삽입 된 행에 대 한 핸들을 검색할지 여부를 나타냅니다.

### <a name="return-value"></a>반환 값

표준 HRESULT입니다.

### <a name="remarks"></a>주의

이 메서드에는 모든 공급자에서 지원 되지 않을 수 있는 선택적 인터페이스 `IRowsetChange`필요 합니다. 이 경우 메서드는 E_NOINTERFACE를 반환 합니다. 또한 행 집합을 포함 하는 테이블이 나 명령에서 `Open`를 호출 하기 전에 `DBPROP_IRowsetChange`를 VARIANT_TRUE으로 설정 해야 합니다.

하나 이상의 열에 쓸 수 없으면 Insert가 실패할 수 있습니다. 이 문제를 해결하려면 커서 맵을 수정합니다.

### <a name="example"></a>예제

다음 예에서는 행 집합을 통해 데이터 원본에 액세스 한 다음 해당 행 집합의 테이블을 사용 하 여 문자열을 삽입 하는 방법을 보여 줍니다.

먼저 프로젝트에 새 ATL 개체를 삽입 하 여 테이블 클래스를 만듭니다. 예를 들어 작업 영역 창에서 프로젝트를 마우스 오른쪽 단추로 클릭 하 고 **새 ATL 개체**를 선택 합니다. **데이터 액세스** 범주에서 **소비자**를 선택 합니다. **Table**형식의 소비자 개체를 만듭니다. **테이블을 선택 하면** 테이블에서 직접 행 집합이 만들어지며, **명령을** 선택 하면 SQL 명령을 통해 행 집합이 만들어집니다. 데이터 원본을 선택 하 여 해당 데이터 원본에 액세스 하는 데 사용할 테이블을 지정 합니다. 소비자 개체 **Ccustomertable**을 호출 하는 경우 다음과 같이 삽입 코드를 구현 합니다.

[!code-cpp[NVC_OLEDB_Consumer#10](../../data/oledb/codesnippet/cpp/crowset-insert_1.cpp)]

## <a name="crowsetissamerow"></a><a name="issamerow"></a>CRowset:: IsSameRow

지정 된 행을 현재 행과 비교 합니다.

### <a name="syntax"></a>구문

```cpp
HRESULT IsSameRow(HROW hRow) const throw();
```

#### <a name="parameters"></a>매개 변수

*hRow*<br/>
진행 현재 행과 비교할 행의 핸들입니다.

### <a name="return-value"></a>반환 값

표준 HRESULT입니다. S_OK는 행이 동일 함을 나타냅니다. 다른 값은 Windows SDK *OLE DB 프로그래머 참조* 에서 [IRowsetIndentity:: IsSameRow](/previous-versions/windows/desktop/ms719629(v=vs.85)) 를 참조 하세요.

## <a name="crowsetmovefirst"></a><a name="movefirst"></a>CRowset:: MoveFirst

커서를 초기 위치로 이동 하 고 초기 행을 검색 합니다.

### <a name="syntax"></a>구문

```cpp
HRESULT MoveFirst() throw();
```

### <a name="return-value"></a>반환 값

표준 HRESULT입니다.

### <a name="remarks"></a>주의

[IRowset:: RestartPosition](/previous-versions/windows/desktop/ms712877(v=vs.85)) 를 호출 하 여 다음 인출 위치를 초기 위치 (행 집합이 만들어질 때 다음 인출 위치 였던 위치)로 변경 하 고 초기 행을 검색 합니다.

## <a name="crowsetmovelast"></a><a name="movelast"></a>CRowset:: MoveLast

커서를 마지막 행으로 이동 합니다.

### <a name="syntax"></a>구문

```cpp
HRESULT MoveLast() throw();
```

### <a name="return-value"></a>반환 값

표준 HRESULT입니다.

### <a name="remarks"></a>주의

[IRowset:: RestartPosition](/previous-versions/windows/desktop/ms712877(v=vs.85)) 를 호출 하 여 다음 인출 위치의 위치를 마지막 위치로 변경 하 고 마지막 행을 검색 합니다.

이 메서드를 사용 하려면 행 집합을 포함 하는 테이블 또는 명령에 대해 `Open`를 호출 하기 전에 `DBPROP_CANSCROLLBACKWARDS`을 VARIANT_TRUE로 설정 해야 합니다. 성능 향상을 위해 `DBPROP_QUICKRESTART`를 VARIANT_TRUE으로 설정할 수도 있습니다.

## <a name="crowsetmovenext"></a><a name="movenext"></a>CRowset:: MoveNext

커서를 다음 레코드로 이동 합니다.

### <a name="syntax"></a>구문

```cpp
HRESULT MoveNext() throw();

HRESULT MoveNext(LONG lSkip,
   bool bForward= true) throw();
```

#### <a name="parameters"></a>매개 변수

*lSkip*<br/>
진행 인출 하기 전에 건너뛸 행의 수입니다.

*bForward*<br/>
진행 다음 레코드로 이동 하려면 **true** 를 전달 하 고, 뒤로 이동 하려면 **false** 를 전달 합니다.

### <a name="return-value"></a>반환 값

표준 HRESULT입니다. 행 집합의 끝에 도달 하면 DB_S_ENDOFROWSET 반환 됩니다.

### <a name="remarks"></a>주의

이전 위치를 기억 하 여 `CRowset` 개체에서 다음 순차 행을 페치합니다. 필요에 따라 *lskip* 행을 건너뛰거나 뒤로 이동 하도록 선택할 수 있습니다.

이 메서드를 사용 하려면 행 집합을 포함 하는 테이블 또는 명령에서 `Open`를 호출 하기 전에 다음 속성을 설정 해야 합니다.

- *Lskip* < 0 인 경우 `DBPROP_CANSCROLLBACKWARDS`를 VARIANT_TRUE 해야 합니다.

- *Bforward* = false 인 경우 `DBPROP_CANFETCHBACKWARDS`를 VARIANT_TRUE 해야 합니다.

그렇지 않은 경우 ( *Lskip* > = 0 및 *bforward* = true 인 경우) 추가 속성을 설정할 필요가 없습니다.

## <a name="crowsetmoveprev"></a><a name="moveprev"></a>CRowset:: MovePrev

커서를 이전 레코드로 이동 합니다.

### <a name="syntax"></a>구문

```cpp
HRESULT MovePrev() throw();
```

### <a name="return-value"></a>반환 값

표준 HRESULT입니다.

### <a name="remarks"></a>주의

이 메서드를 사용 하려면 행 집합을 포함 하는 테이블 또는 명령에 대 한 `Open`를 호출 하기 전에 `DBPROP_CANFETCHBACKWARDS` 또는 `DBPROP_CANSCROLLBACKWARDS`를 VARIANT_TRUE으로 설정 해야 합니다.

## <a name="crowsetmovetobookmark"></a><a name="movetobookmark"></a>CRowset:: MoveToBookmark

책갈피 또는 해당 책갈피에서 지정 된 오프셋 (*Lskip*)의 행으로 표시 된 행을 인출 합니다.

### <a name="syntax"></a>구문

```cpp
HRESULT MoveToBookmark(const CBookmarkBase& bookmark,
   LONG lSkip = 0) throw();
```

#### <a name="parameters"></a>매개 변수

*책갈피*<br/>
진행 데이터를 가져올 위치를 표시 하는 책갈피입니다.

*lSkip*<br/>
진행 책갈피에서 대상 행 까지의 행 개수입니다. *Lskip* 이 0 이면 인출 된 첫 번째 행이 책갈피가 설정 된 행입니다. *Lskip* 이 1 이면 인출 된 첫 번째 행이 책갈피가 설정 된 행 뒤의 행입니다. *Lskip* 이-1 이면 인출 된 첫 번째 행이 책갈피가 설정 된 행 앞의 행입니다.

### <a name="return-value"></a>반환 값

표준 HRESULT입니다.

### <a name="remarks"></a>주의

이 메서드에는 모든 공급자에서 지원 되지 않을 수 있는 선택적 인터페이스 `IRowsetLocate`필요 합니다. 이 경우 메서드는 E_NOINTERFACE를 반환 합니다. 행 집합을 포함 하는 테이블이 나 명령에 대해 `Open`를 호출 하기 전에 `DBPROP_IRowsetLocate`을 VARIANT_TRUE로 설정 하 고 `DBPROP_CANFETCHBACKWARDS`를 VARIANT_TRUE로 설정 해야 합니다.

소비자에서 책갈피를 사용 하는 방법에 대 한 자세한 내용은 [책갈피 사용](../../data/oledb/using-bookmarks.md)을 참조 하세요.

## <a name="crowsetmovetoratio"></a><a name="movetoratio"></a>CRowset:: MoveToRatio

행 집합의 소수 위치에서 시작 하 여 행을 인출 합니다.

### <a name="syntax"></a>구문

```cpp
HRESULT MoveToRatio(DBCOUNTITEM nNumerator,
   DBCOUNTITEM nDenominator,bool bForward = true) throw();
```

#### <a name="parameters"></a>매개 변수

*nNumerator*<br/>
진행 데이터를 페치할 소수 위치를 결정 하는 데 사용 되는 분자입니다.

*nDenominator*<br/>
진행 데이터를 페치할 소수 자릿수를 결정 하는 데 사용 되는 분모입니다.

*bForward*<br/>
진행 앞뒤로 이동할지 여부를 나타냅니다. 기본값은 전달입니다.

### <a name="return-value"></a>반환 값

표준 HRESULT입니다.

### <a name="remarks"></a>주의

`MoveToRatio`는 다음 수식에 따라 행을 페치합니다.

`(nNumerator *  RowsetSize ) / nDenominator`

여기서 `RowsetSize`는 행 단위로 측정 되는 행 집합의 크기입니다. 이 수식의 정확도는 특정 공급자에 따라 달라 집니다. 자세한 내용은 [IRowsetScroll:: GetRowsAtRatio](/previous-versions/windows/desktop/ms709602(v=vs.85))를 참조 하세요.

이 메서드에는 모든 공급자에서 지원 되지 않을 수 있는 선택적 인터페이스 `IRowsetScroll`필요 합니다. 이 경우 메서드는 E_NOINTERFACE를 반환 합니다. 또한 행 집합을 포함 하는 테이블이 나 명령에서 `Open`를 호출 하기 전에 `DBPROP_IRowsetScroll`를 VARIANT_TRUE으로 설정 해야 합니다.

## <a name="crowsetreleaserows"></a><a name="releaserows"></a>CRowset:: ReleaseRows

[IRowset:: ReleaseRows](/previous-versions/windows/desktop/ms719771(v=vs.85)) 를 호출 하 여 현재 행 핸들을 해제 합니다.

### <a name="syntax"></a>구문

```cpp
HRESULT ReleaseRows() throw();
```

### <a name="return-value"></a>반환 값

표준 HRESULT입니다.

## <a name="crowsetsetdata"></a><a name="setdata"></a>CRowset:: SetData

하나 이상의 행 열에 데이터 값을 설정 합니다.

### <a name="syntax"></a>구문

```cpp
HRESULT SetData() const throw();

HRESULT SetData(int nAccessor) const throw();
```

#### <a name="parameters"></a>매개 변수

*nAccessor*<br/>
진행 데이터에 액세스 하는 데 사용할 접근자의 번호입니다.

### <a name="return-value"></a>반환 값

표준 HRESULT입니다.

### <a name="remarks"></a>주의

인수를 허용 하지 않는 `SetData` 폼의 경우 모든 접근자가 업데이트에 사용 됩니다. 일반적으로 `SetData`를 호출 하 여 행의 열에 데이터 값을 설정한 다음 [Update](../../data/oledb/crowset-update.md) 를 호출 하 여 이러한 변경 내용을 전송 합니다.

이 메서드에는 모든 공급자에서 지원 되지 않을 수 있는 선택적 인터페이스 `IRowsetChange`필요 합니다. 이 경우 메서드는 E_NOINTERFACE를 반환 합니다. 또한 행 집합을 포함 하는 테이블이 나 명령에서 `Open`를 호출 하기 전에 `DBPROP_IRowsetChange`를 VARIANT_TRUE으로 설정 해야 합니다.

하나 이상의 열에 쓸 수 없는 경우 설정 작업이 실패할 수 있습니다. 이 문제를 해결하려면 커서 맵을 수정합니다.

## <a name="crowsetundo"></a><a name="undo"></a>CRowset:: Undo

마지막 인출 또는 [업데이트](../../data/oledb/crowset-update.md)이후 행에 적용 된 변경 내용을 취소 합니다.

### <a name="syntax"></a>구문

```cpp
HRESULT Undo(DBCOUNTITEM* pcRows = NULL,
   HROW* phRow = NULL,
   DBROWSTATUS* pStatus = NULL) throw();
```

#### <a name="parameters"></a>매개 변수

*pcRows*<br/>
제한이 필요한 경우 실행 취소 하려고 시도한 행의 수를 `Undo`가 반환 되는 위치에 대 한 포인터입니다.

*phRow*<br/>
제한이 필요한 경우 실행 취소 하려고 시도한 모든 행에 대 한 핸들의 배열을 반환 하는 `Undo` 위치에 대 한 포인터입니다.

*pStatus*<br/>
제한이 `Undo` 행 상태 값을 반환 하는 위치에 대 한 포인터입니다. *Pstatus* 가 null 인 경우에는 상태가 반환 되지 않습니다.

### <a name="return-value"></a>반환 값

표준 HRESULT입니다.

### <a name="remarks"></a>주의

이 메서드에는 모든 공급자에서 지원 되지 않을 수 있는 선택적 인터페이스 `IRowsetUpdate`필요 합니다. 이 경우 메서드는 E_NOINTERFACE를 반환 합니다. 또한 행 집합을 포함 하는 테이블이 나 명령에서 `Open`를 호출 하기 전에 `DBPROP_IRowsetUpdate`를 VARIANT_TRUE으로 설정 해야 합니다.

## <a name="crowsetupdate"></a><a name="update"></a>CRowset:: Update

마지막 인출 또는 `Update` 호출 이후 현재 행에 대해 보류 중인 변경 내용을 모두 전송 합니다.

### <a name="syntax"></a>구문

```cpp
HRESULT Update(DBCOUNTITEM* pcRows = NULL,
   HROW* phRow = NULL,
   DBROWSTATUS* pStatus = NULL) throw();
```

#### <a name="parameters"></a>매개 변수

*pcRows*<br/>
제한이 필요한 경우 업데이트 하려고 시도한 행의 수를 `Update`를 반환 하는 위치에 대 한 포인터입니다.

*phRow*<br/>
제한이 `Update` 업데이트 하려고 시도한 행의 핸들을 반환 하는 위치에 대 한 포인터입니다. *Phrow* 가 null 이면 핸들이 반환 되지 않습니다.

*pStatus*<br/>
제한이 `Update` 행 상태 값을 반환 하는 위치에 대 한 포인터입니다. *Pstatus* 가 null 인 경우에는 상태가 반환 되지 않습니다.

### <a name="return-value"></a>반환 값

표준 HRESULT입니다.

### <a name="remarks"></a>주의

`Update` 또는 [UpdateAll](../../data/oledb/crowset-updateall.md)를 사용 하 여 해당 행이 마지막으로 인출 되거나 업데이트 된 이후 현재 행에 대해 보류 중인 변경 내용을 모두 전송 합니다. 일반적으로 [SetData](../../data/oledb/crowset-setdata.md) 를 호출 하 여 행의 열에 데이터 값을 설정 하 고 `Update`를 호출 하 여 해당 변경 내용을 전송 합니다.

이 메서드에는 모든 공급자에서 지원 되지 않을 수 있는 선택적 인터페이스 `IRowsetUpdate`필요 합니다. 이 경우 메서드는 E_NOINTERFACE를 반환 합니다. 또한 행 집합을 포함 하는 테이블이 나 명령에서 `Open`를 호출 하기 전에 `DBPROP_IRowsetUpdate`를 VARIANT_TRUE으로 설정 해야 합니다.

## <a name="crowsetupdateall"></a><a name="updateall"></a>CRowset:: UpdateAll

마지막 인출 또는 `Update` 호출 이후 모든 행에 대해 보류 중인 변경 내용을 모두 전송 합니다.

### <a name="syntax"></a>구문

```cpp
HRESULT UpdateAll(DBCOUNTITEM* pcRows = NULL,
   HROW** pphRow = NULL,
   DBROWSTATUS** ppStatus = NULL) throw();
```

#### <a name="parameters"></a>매개 변수

*pcRows*<br/>
제한이 필요한 경우 업데이트 하려고 시도한 행의 수를 `UpdateAll`를 반환 하는 위치에 대 한 포인터입니다.

*pphRow*<br/>
제한이 `UpdateAll` 업데이트 하려고 시도한 행의 핸들을 반환 하는 메모리에 대 한 포인터입니다. *Pphrow* 가 null 이면 핸들이 반환 되지 않습니다.

*ppStatus*<br/>
제한이 `Update` 행 상태 값을 반환 하는 위치에 대 한 포인터입니다. *Ppstatus* 가 null 인 경우에는 상태가 반환 되지 않습니다.

### <a name="remarks"></a>주의

[업데이트](../../data/oledb/crowset-update.md) 또는 `UpdateAll`를 사용 하 여 해당 행이 마지막으로 인출 되거나 업데이트 된 후 모든 행에 대 한 보류 중인 변경 내용을 전송 합니다. 이에 대 한 핸들이 아직 있는지 여부에 관계 없이 ( *Pphrow*참조) 수정 된 모든 행을 업데이트 `UpdateAll` 합니다.

예를 들어 `Insert`를 사용 하 여 행 집합에 5 개의 행을 삽입 하는 경우 `Update`를 5 번 호출 하거나 `UpdateAll`를 한 번 호출 하 여 모두 업데이트할 수 있습니다.

이 메서드에는 모든 공급자에서 지원 되지 않을 수 있는 선택적 인터페이스 `IRowsetUpdate`필요 합니다. 이 경우 메서드는 E_NOINTERFACE를 반환 합니다. 또한 행 집합을 포함 하는 테이블이 나 명령에서 `Open`를 호출 하기 전에 `DBPROP_IRowsetUpdate`를 VARIANT_TRUE으로 설정 해야 합니다.

### <a name="return-value"></a>반환 값

표준 HRESULT입니다.

## <a name="see-also"></a>참고 항목

[DBViewer 샘플](../../overview/visual-cpp-samples.md)<br/>
[MultiRead 샘플](../../overview/visual-cpp-samples.md)<br/>
[MultiRead 특성 샘플](../../overview/visual-cpp-samples.md)<br/>
[OLE DB 소비자 템플릿](../../data/oledb/ole-db-consumer-templates-cpp.md)<br/>
[OLE DB 소비자 템플릿 참조](../../data/oledb/ole-db-consumer-templates-reference.md)
